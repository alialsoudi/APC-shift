<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shift Calendar</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
    font-family:'Inter',sans-serif;
    background:#f4f6f8;
}

/* Card */
.card{
    background:#ffffff;
    border-radius:14px;
    border:1px solid #e5e7eb;
}

/* Calendar cell */
.day-cell{
    aspect-ratio:1/1;
    border-radius:6px;
    padding:4px 2px;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    align-items:center;
    font-weight:600;
    text-align:center;
}

/* Day number */
.day-number{
    font-size:11px;
    font-weight:700;
    color:#111827;
}

/* Shift text */
.shift-label{
    font-size:8px;
    font-weight:700;
    line-height:1.1;
    text-transform:uppercase;
}

/* Soft colors */
.shift-morning{
    background:#dcfce7;
    color:#166534;
}

.shift-afternoon{
    background:#dbeafe;
    color:#1e40af;
}

.shift-night{
    background:#fef3c7;
    color:#92400e;
}

.shift-off{
    background:#fde8e8;
    color:#b91c1c;
}

/* Controls */
.control-label{
    font-size:10px;
    font-weight:700;
    color:#6b7280;
    margin-bottom:2px;
    display:block;
}

.control-input{
    width:100%;
    border-radius:10px;
    border:1px solid #d1d5db;
    padding:8px 10px;
    font-size:12px;
    font-weight:600;
}
</style>
</head>

<body class="antialiased">

<div class="max-w-md mx-auto px-3 py-4 space-y-4">

<!-- Header -->
<div class="text-center">
    <h1 class="text-xl font-bold">Shift Calendar</h1>
    <p class="text-[10px] text-gray-400">Compact Monthly Schedule</p>
</div>

<!-- Controls -->
<div class="card p-3 grid grid-cols-2 gap-3">
    <div>
        <label class="control-label">Shift Group</label>
        <select id="shiftSelect" class="control-input">
            <option value="A">Group A</option>
            <option value="B">Group B</option>
            <option value="C">Group C</option>
            <option value="D">Group D</option>
        </select>
    </div>

    <div>
        <label class="control-label">Month</label>
        <input type="month" id="monthPicker" class="control-input">
    </div>
</div>

<!-- Calendar -->
<div class="card">

    <!-- Month header -->
    <div id="calendarHeader"
         class="text-center py-2 font-semibold text-sm border-b"></div>

    <!-- Week days -->
    <div class="grid grid-cols-7 text-center text-[9px] font-semibold text-gray-400 border-b">
        <div>Sun</div><div>Mon</div><div>Tue</div>
        <div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
    </div>

    <!-- Days -->
    <div id="calendarGrid" class="grid grid-cols-7 gap-[2px] p-[2px]"></div>
</div>

<!-- Export Button -->
<button onclick="exportToCalendar()"
        class="w-full bg-gray-900 text-white text-xs font-bold py-3 rounded-xl tracking-widest active:scale-95 transition">
    EXPORT CALENDAR
</button>

</div>

<script>
const refDate = new Date(2025,11,18);
const sequence = ['A','A','A','M','M','M','O','O','O','N','N','N'];
const groupOffsets = {A:0,B:3,C:6,D:9};
const shiftLabels = {
    M:'Morning',
    A:'After<br>Noon',
    N:'Night',
    O:'Off'
};

const monthPicker = document.getElementById('monthPicker');
const shiftSelect = document.getElementById('shiftSelect');
const calendarGrid = document.getElementById('calendarGrid');

const now = new Date();
monthPicker.value = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}`;

function render(){
    const [y,m] = monthPicker.value.split('-').map(Number);
    const first = new Date(y,m-1,1);
    const days = new Date(y,m,0).getDate();
    const start = first.getDay();

    document.getElementById('calendarHeader').innerText =
        first.toLocaleString('en-US',{month:'long',year:'numeric'});

    calendarGrid.innerHTML='';

    for(let i=0;i<start;i++){
        calendarGrid.innerHTML+='<div></div>';
    }

    for(let d=1;d<=days;d++){
        const cur = new Date(y,m-1,d);
        let idx = Math.floor((cur-refDate)/(86400000)) + groupOffsets[shiftSelect.value];
        idx = ((idx%12)+12)%12;

        const t = sequence[idx];
        const cls = t==='M'?'shift-morning':t==='A'?'shift-afternoon':t==='N'?'shift-night':'shift-off';

        calendarGrid.innerHTML += `
        <div class="day-cell ${cls}">
            <div class="day-number">${d}</div>
            <div class="shift-label">${shiftLabels[t]}</div>
        </div>`;
    }
}

function exportToCalendar(){
    const [y,m] = monthPicker.value.split('-').map(Number);
    const days = new Date(y,m,0).getDate();
    let ics = "BEGIN:VCALENDAR\nVERSION:2.0\n";

    for(let d=1;d<=days;d++){
        const cur=new Date(y,m-1,d);
        let idx=Math.floor((cur-refDate)/(86400000))+groupOffsets[shiftSelect.value];
        idx=((idx%12)+12)%12;
        if(sequence[idx]==='O') continue;

        const s=cur.toISOString().slice(0,10).replace(/-/g,'');
        const n=new Date(cur);n.setDate(cur.getDate()+1);
        const e=n.toISOString().slice(0,10).replace(/-/g,'');

        ics+=`BEGIN:VEVENT\nSUMMARY:${shiftLabels[sequence[idx]].replace('<br>',' ')} Shift\nDTSTART;VALUE=DATE:${s}\nDTEND;VALUE=DATE:${e}\nEND:VEVENT\n`;
    }
    ics+="END:VCALENDAR";

    const a=document.createElement('a');
    a.href=URL.createObjectURL(new Blob([ics],{type:'text/calendar'}));
    a.download="shifts.ics";
    a.click();
}

[monthPicker,shiftSelect].forEach(e=>e.addEventListener('change',render));
render();
</script>

</body>
</html>